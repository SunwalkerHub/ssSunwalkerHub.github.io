---
title: IoT 正向开发：iMX6 开发板 选型
categories:
- IOT
tags: 
---

> 更新中...最近需要使用一个通信模组的SDK，其运行在嵌入式linux上，包括了设备树和内核的patch、驱动、用户态库和可执行程序等，文档中说明其适配了i.MX6QSABRESD（ARM32）。我知道市面上有非常多的iMX6的开发板，作为练习IoT正向开发的开始，我希望自己编译uboot、linux运行在板子上，然后探索其中的道理。同时也是为了在使用SDK的过程中，能更好的排错。我先后体验了四家公司的开发板，分别是：百问网、迅为、飞思卡尔、野火。本以为很容易，没想到的是，倘若是怀着探索实现原理心态去看一些的开发板教程，那真是如此的令人费解。所以本篇的选型，说的不是性能，而是在我踩坑的过程中，看到了谁家的开发板能让学习者对计算机看的更透，更清楚。

## 尝试

### 百问网 

首先尝试是韦东山老师百问网的IMX6ULLMINI：

> 相关资料：[100ASK_IMX6ULL_MINI开发板](https://download.100ask.org/boards/Nxp/100ask_imx6ull_mini/index.html)

![image](https://xuanxuanblingbling.github.io/assets/pic/imx6/100ask.jpeg)

用这块板子的原因一是不明白，二是手里有：

1. 开始尝试这个，大家就能看出来我这个空子纯外行，人家SDK适配的是i.MX6Q，而这块板子是i.MX6ULL
2. 这块板子是因为鸿蒙买的：[华为鸿蒙系统移植到imx6ull成功](https://zhuanlan.zhihu.com/p/232860040)

虽然早就听闻过韦东山老师的大名，但还是第一次看他板子的相关资料，总体感觉并不是很好，但可以理解：

> 文档链接:[https://pan.baidu.com/s/1OMX-3tFW2PUsRWdjjgCRzw](https://pan.baidu.com/s/1OMX-3tFW2PUsRWdjjgCRzw)  密码:oh4z

1. 由于主要面向真的是纯新手，所以资料傻瓜化，很多步骤被封成了一个脚本，理解麻烦
2. 由于嵌入式不同板子间的知识是有重叠的，所以产生了学习资料复用，看起来非常的乱套
3. 由于经过多年的发展和积累，资料的维护和更新也比较乱套，导致资料非常多，但可能用不上

对于这张板子，测试直接编译uboot主线代码并烧录进SD卡是成功的，过程如下：

```python
➜  git clone https://github.com/u-boot/u-boot.git
➜  sudo apt install -y gcc bison flex gcc-arm-linux-gnueabi libssl-dev
➜  cd u-boot/
➜  make mx6ull_14x14_evk_defconfig
➜  make ARCH=arm CROSS_COMPILE=arm-linux-gnueabi-
```

这里直接使用了ubuntu的apt安装的交叉编译工具，最终编译出的u-boot-dtb.imx即是uboot镜像。编译过程中需要解释的是：为什么要写mx6ull_14x14_evk_defconfig？还有没有别的？写别的行不行？

- 首先可以在文档的204页看到编译他们提供的uboot是此参数
- 此参数是在configs文件夹下的配置文件，如下，不同参数对应不同开发板，所以一般来说不能写别的

```c
➜  ls -al ./configs/ | grep imx6ull
-rw-r--r--     1 xuanxuan  staff   2200 12 30 18:23 colibri-imx6ull-emmc_defconfig
-rw-r--r--     1 xuanxuan  staff   2710 12 30 18:23 colibri-imx6ull_defconfig
-rw-r--r--     1 xuanxuan  staff   1316 12 30 18:23 o4-imx6ull-nano_defconfig
-rw-r--r--     1 xuanxuan  staff   1744 12 30 18:23 seeed_npi_imx6ull_defconfig
➜  ls -al ./configs/ | grep mx6ull 
-rw-r--r--     1 xuanxuan  staff   2200 12 30 18:23 colibri-imx6ull-emmc_defconfig
-rw-r--r--     1 xuanxuan  staff   2710 12 30 18:23 colibri-imx6ull_defconfig
-rw-r--r--     1 xuanxuan  staff   1361 12 30 18:23 mx6ull_14x14_evk_defconfig
-rw-r--r--     1 xuanxuan  staff   1333 12 30 18:23 mx6ull_14x14_evk_plugin_defconfig
-rw-r--r--     1 xuanxuan  staff   1316 12 30 18:23 o4-imx6ull-nano_defconfig
-rw-r--r--     1 xuanxuan  staff   1744 12 30 18:23 seeed_npi_imx6ull_defconfig
```

然后将u-boot-dtb.imx烧录到SD卡中，跳过两个扇区是imx6的镜像标准：[IMX_LINUX_USERS_GUIDE.pdf](https://www.nxp.com/docs/en/user-guide/IMX_LINUX_USERS_GUIDE.pdf)

```c
sudo dd if=u-boot-dtb.imx of=/dev/sdb seek=2
```

最后将拨码开关从1-4分别设置为ON ON ON OFF，重新上电即可从SD卡启动，通过串口可见，成功启动到uboot shell：

```c
U-Boot 2022.01-rc4-00030-gb3f84a939f (Dec 30 2021 - 02:26:02 -0800)

CPU:   Freescale i.MX6ULL rev1.1 792 MHz (running at 396 MHz)
CPU:   Industrial temperature grade (-40C to 105C) at 43C
Reset cause: POR
Model: Freescale i.MX6 UltraLiteLite 14x14 EVK Board
Board: MX6ULL 14x14 EVK
DRAM:  512 MiB
MMC:   FSL_SDHC: 0, FSL_SDHC: 1
Loading Environment from MMC... *** Warning - bad CRC, using default environment

In:    serial
Out:   serial
Err:   serial
Net:   Could not get PHY for FEC1: addr 1
Could not get PHY for FEC1: addr 1
Get shared mii bus on ethernet@2188000
Could not get PHY for FEC1: addr 2
Get shared mii bus on ethernet@2188000
Could not get PHY for FEC1: addr 2
No ethernet found.

Hit any key to stop autoboot:  0 
=> 
=> 
=> 
```

之后也尝试了在这张板子上直接编译linux主线内核与buildroot文件系统，虽然有一些要改uboot启动参数的坑，但最后均成功启动。不过后来看到了其SDK适配的i.MX6Q，并且还在设备树上做了修改，我就知道用这张板子是不太可能直接跑通的，因为imx6q和imx6ull根本就是两个不同的SoC：

- [i.MX6Q: i.MX 6Quad Processors](https://www.nxp.com/products/processors-and-microcontrollers/arm-processors/i-mx-applications-processors/i-mx-6-processors/i-mx-6quad-processors-high-performance-3d-graphics-hd-video-arm-cortex-a9-core:i.MX6Q)
- [i.MX6ULL: i.MX 6ULL Single-Core Processor](https://www.nxp.com/products/processors-and-microcontrollers/arm-processors/i-mx-applications-processors/i-mx-6-processors/i-mx-6ull-single-core-processor-with-arm-cortex-a7-core:i.MX6ULL)

所以这张板子也就暂时玩到这了，其他参考：

- [IMX6的U-boot.imx分析及sd卡烧录详解（dd命令写入）](https://blog.csdn.net/p1279030826/article/details/105730676)
- [100ASK-IMX6ULL开发板移值NXP官方UBOOT](https://blog.csdn.net/u014783685/article/details/104951681/)
- [i.MX 6ULL研究笔记_硬件篇](https://wzhchen.github.io/%E8%8A%AF%E7%89%87%E6%96%B9%E6%A1%88/imx6/imx6ull%E6%96%B9%E6%A1%88%E7%A0%94%E7%A9%B6_%E7%A1%AC%E4%BB%B6%E7%AF%87/)
- [u-boot：移植u-boot-2021.01到正点原子imx6ull mini开发板](https://blog.csdn.net/weixin_44498318/article/details/117399841)


### 迅为

因为之前买过迅为的4412开发板，于是搜到了他们家的确有i.MX6Q开发板：

- [迅为：i.MX6Q开发板-连接器版本](http://www.topeetboard.com/Product/iMX6.html)
- [迅为：i.MX6Q开发板-邮票孔版本](http://www.topeetboard.com/Product/iMX61.html)

但这只能看出来是i.MX6Q，是不是i.MX6QSABRESD呢？于是搜到：

- [编译nxp官方yocto在imx6q开发板运行, gpu不能正常工作](http://bbs.topeetboard.com/forum.php?mod=viewthread&tid=19839&highlight=imx6q)

其中提到：yocto执行配置是MACHINE=imx6qsabresd。暂时不必去理会yocto是个啥，但看到配置和目标的确一致，那看起来很靠谱了，所以淘宝买了，版本是迅为四核商业级2G+16G：

> 文档链接:[https://pan.baidu.com/s/1JCSz_J05aujdSJOfEKNf3w](https://pan.baidu.com/s/1JCSz_J05aujdSJOfEKNf3w)  密码:wxrd

![image](https://xuanxuanblingbling.github.io/assets/pic/imx6/topeet.jpeg)

更多的资料就不放了，买完进群会给百度网盘链接，资料类似百问网的，一堆魔改的代码和纯新手教学。同样是看uboot主线代码，本以为跟百问网的一样简单，但编译时却并没看到imx6qsabresd的配置文件：

```
➜  ls -al ./configs/ | grep imx6qs
➜  ls -al ./configs/ | grep mx6qs 
-rw-r--r--     1 xuanxuan  staff   2224 12 30 18:23 mx6qsabrelite_defconfig
```

后来想到可能是飞思卡尔这张板子的配置并没有进入到uboot主线，于是找到：[uboot-imx](https://source.codeaurora.org/external/imx/uboot-imx)，可以通过网页上的tree标签来看到代码文件，但直接查看还是没有此配置，但如果查看lf_v2021.04此分支则能看到：

- [https://source.codeaurora.org/external/imx/uboot-imx/tree/configs/mx6qsabresd_defconfig?h=lf_v2021.04](https://source.codeaurora.org/external/imx/uboot-imx/tree/configs/mx6qsabresd_defconfig?h=lf_v2021.04)

然后就是尝试用这个版本的uboot，git clone需要比较好的网速：

```python
➜  sudo apt install -y gcc bison flex gcc-arm-linux-gnueabi libssl-dev
➜  git clone -b lf_v2021.04 https://source.codeaurora.org/external/imx/uboot-imx
➜  cd uboot-imx
➜  make mx6qsabresd_defconfig
➜  make ARCH=arm CROSS_COMPILE=arm-linux-gnueabi-
➜  sudo dd if=u-boot-dtb.imx of=/dev/sdb seek=2
```


- [i.mx6q u-boot2016.03移植笔记](https://blog.csdn.net/u013215852/article/details/82813826)
- [基于IMX6Q的u-boot-2017.11的移植（1）->初步移植](https://blog.csdn.net/qq_15015097/article/details/78975494)
- [基于IMX6Q的u-boot-2017.11的移植（2）->MMC移植](https://blog.csdn.net/qq_15015097/article/details/78994676)
- [基于IMX6Q的u-boot-2017.11的移植（3）->Ethernet MAC (ENET)移植](https://blog.csdn.net/qq_15015097/article/details/79007735)
- [迅为iMX6Q开发板：uboot-imx移植与编译](https://blog.csdn.net/tcjy1000/article/details/95101401)


### 飞思卡尔

google搜索imx6qsabresd，结果就是 [RD-IMX6Q-SABRE](https://www.nxp.com/design/development-boards/i-mx-evaluation-and-development-boards/sabre-board-for-smart-devices-based-on-the-i-mx-6quad-applications-processors:RD-IMX6Q-SABRE) 这张板子。因为没有淘宝京东，而且比较着急，所以从咸鱼买了两块回来，每块2000元左右：

> 相关资料：可直接在产品页面底部下载，需注册NXP账号

![image](https://xuanxuanblingbling.github.io/assets/pic/imx6/freescale.jpeg)

### 野火

其实使用飞思卡尔官方开发板已经把SDK成功运行了，但在前几天的SCTF遇到了用野火imx6板子出的题目：

- [2021 SCTF SU Writeup: easyiot](https://team-su.github.io/passages/2021-12-25-SCTF/)

虽然题目本身非常脑洞与无厘头，但这题让我发现野火的教程是非常用心的：

> 资料链接：[i.MX Linux开发实战指南](http://doc.embedfire.com/linux/imx6/base/zh/latest/index.html)

![image](https://xuanxuanblingbling.github.io/assets/pic/imx6/embedfire.jpeg)

开发板上用来选择启动方式的拨码开关一直是一个比较麻烦的问题，一般来说都需要找开发手册才能知道怎么玩，但可以看到野火非常贴心的将其选择方式印到了开关附近，着实很贴心。后来发现百问网的也有，就是在板子背面，但迅为和飞思卡尔是真没有。

```
git clone https://github.com/u-boot/u-boot.git
sudo apt install -y gcc bison flex gcc-arm-linux-gnueabi libssl-dev
cd u-boot/
make mx6ull_14x14_evk_defconfig
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabi-
```


## 总结